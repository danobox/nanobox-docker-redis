# -*- mode: apacheconf; -*-
daemonize no
pidfile /var/run/redis.pid
port 6380
# bind 127.0.0.1
timeout 0
tcp-keepalive <%= boxfile[:tcp_keepalive] %>
loglevel notice
# syslog-enabled no
# syslog-ident redis
# syslog-facility local0
databases <%= boxfile[:databases] %>
save 900 1
save 300 10
save 60 10000

stop-writes-on-bgsave-error <%= boxfile[:stop_writes_on_bgsave_error] %>
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
dir /data/var/db/redis

slave-serve-stale-data <%= boxfile[:slave_serve_stale_data] %>
slave-read-only <%= boxfile[:slave_read_only] %>
repl-ping-slave-period <%= boxfile[:repl_ping_slave_period] %>
repl-timeout <%= boxfile[:repl_timeout] %>
repl-disable-tcp-nodelay <%= boxfile[:repl_disable_tcp_nodelay] %>

maxclients <%= boxfile[:max_clients] %>
maxmemory <%= maxmemory %>m
maxmemory-policy <%= boxfile[:maxmemory_policy] %>
maxmemory-samples <%= boxfile[:maxmemory_samples] %>
appendonly no
appendfilename appendonly.aof
appendfsync <%= boxfile[:appendfsync] %>
no-appendfsync-on-rewrite <%= boxfile[:no_appendfsync_on_rewrite] %>
auto-aof-rewrite-percentage <%= boxfile[:auto_aof_rewrite_percentage] %>
auto-aof-rewrite-min-size <%= boxfile[:auto_aof_rewrite_min_size] %>
lua-time-limit <%= boxfile[:lua_time_limit] %>
slowlog-log-slower-than <%= boxfile[:slowlog_log_slower_than] %>
slowlog-max-len <%= boxfile[:slowlog_max_len] %>

hash-max-ziplist-entries <%= boxfile[:hash_max_ziplist_entries] %>
hash-max-ziplist-value <%= boxfile[:hash_max_ziplist_value] %>

list-max-ziplist-entries <%= boxfile[:list_max_ziplist_entries] %>
list-max-ziplist-value <%= boxfile[:list_max_ziplist_value] %>

set-max-intset-entries <%= boxfile[:set_max_intset_entries] %>

zset-max-ziplist-entries <%= boxfile[:zset_max_ziplist_entries] %>
zset-max-ziplist-value <%= boxfile[:zset_max_ziplist_value] %>

activerehashing <%= boxfile[:activerehashing] %>

client-output-buffer-limit normal 0 0 0
client-output-buffer-limit slave 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

hz <%= boxfile[:hz] %>

aof-rewrite-incremental-fsync <%= boxfile[:aof_rewrite_incremental_fsync] %>
<% if slaveof -%>
slaveof <%= slaveof %> 6380
<% end -%>
